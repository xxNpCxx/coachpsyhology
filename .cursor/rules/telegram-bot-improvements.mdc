---
alwaysApply: true
---

# üìù Telegram Bot Development - –£–ª—É—á—à–µ–Ω–∏—è –∏ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:

### 1. –î–≤–æ–π–Ω–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å reply_markup
**–î–∞—Ç–∞:** 04.12.2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏–∏ `Markup.keyboard()` –∏ `Markup.inlineKeyboard()` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–±—ä–µ–∫—Ç —Å `reply_markup`, —á—Ç–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ `ctx.reply({ reply_markup: ... })` —Å–æ–∑–¥–∞–µ—Ç –¥–≤–æ–π–Ω—É—é –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å.

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–Ω–æ–ø–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Telegram
- –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É JSON
- –ö–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
await ctx.reply('–¢–µ–∫—Å—Ç', { reply_markup: Markup.keyboard([...]) });

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –°–ø–æ—Å–æ–± 1
await ctx.reply('–¢–µ–∫—Å—Ç', { reply_markup: Markup.keyboard([...]).reply_markup });

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –°–ø–æ—Å–æ–± 2 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
await ctx.reply('–¢–µ–∫—Å—Ç', {
  reply_markup: {
    keyboard: [...],
    resize_keyboard: true
  }
});
```

**–ü—Ä–∞–≤–∏–ª–æ:** –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä—è–º—ã–µ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä –∏–ª–∏ –¥–æ–±–∞–≤–ª—è–π `.reply_markup` –∫ —Ñ—É–Ω–∫—Ü–∏—è–º Markup.

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö callback queries –±–ª–æ–∫–∏—Ä—É–µ—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
**–î–∞—Ç–∞:** 04.12.2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `bot.action(/.*/, ...)` –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –í–°–ï callback queries —Ä–∞–Ω—å—à–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–Ω–æ–ø–∫–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- –í—Å–µ callback queries –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞"
- –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤—ã–∑–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –≤ –Ω–∞—á–∞–ª–µ –∏–ª–∏ —Å–µ—Ä–µ–¥–∏–Ω–µ —Ñ–∞–π–ª–∞
bot.action(/.*/, async (ctx) => { ... });

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –°–ê–ú–´–ú –ü–û–°–õ–ï–î–ù–ò–ú –≤ —Ñ–∞–π–ª–µ
// –í—Å–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
bot.action('admin_stats', ...);
bot.action('admin_users', ...);
// ... –¥—Ä—É–≥–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ü–û–°–õ–ï–î–ù–ò–ú
bot.action(/.*/, async (ctx) => {
  console.log('‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π callback query:', ctx.callbackQuery?.data);
  await ctx.answerCbQuery('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞');
});
```

**–ü—Ä–∞–≤–∏–ª–æ:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (regex patterns) –≤—Å–µ–≥–¥–∞ —Ä–∞–∑–º–µ—â–∞–π –ü–û–°–õ–ï–î–ù–ò–ú–ò –≤ —Ñ–∞–π–ª–µ.

## üõ†Ô∏è –ú–ï–¢–û–î–û–õ–û–ì–ò–Ø –û–¢–õ–ê–î–ö–ò:

### –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:
1. –°–æ–∑–¥–∞–π –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç:
```javascript
bot.command('test_simple', async (ctx) => {
  await ctx.reply('–¢–µ—Å—Ç inline:', {
    reply_markup: {
      inline_keyboard: [[{ text: '‚úÖ –¢–µ—Å—Ç', callback_data: 'test' }]]
    }
  });
});
```

2. –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–¥–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
3. –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ middleware/–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö

### Callback queries –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏
2. –î–æ–±–∞–≤—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

## üìã –ö–û–ù–¢–†–û–õ–¨–ù–´–ï –°–ü–ò–°–ö–ò:

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä:
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É JSON –≤ –ª–æ–≥–∞—Ö –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–≤–æ–π–Ω–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –ø—Ä–æ—Å—Ç—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- [ ] –£–±–µ–¥–∏–ª—Å—è, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä—è–º—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏–ª–∏ `.reply_markup`
- [ ] –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞

### –ü—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –ø—Ä–æ–±–ª–µ–º:
- [ ] –°–æ–∑–¥–∞–ª –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π –ø—Ä–∏–º–µ—Ä  
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫
- [ ] –°—Ä–∞–≤–Ω–∏–ª —Å —Ä–∞–±–æ—á–∏–º –∫–æ–¥–æ–º
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –ø–æ—ç—Ç–∞–ø–Ω–æ (–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É)

### 3. –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
**–î–∞—Ç–∞:** 04.08.2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ –ù–∏–∫–æ–ª—å –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏, —Ö–æ—Ç—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**
PostgreSQL —Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω. –í –∑–∞–ø—Ä–æ—Å–∞—Ö `WHERE user_id = $1` –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ `"6800628442"`, –∞ –≤ –±–∞–∑–µ —Ö—Ä–∞–Ω–∏–ª—Å—è –∫–∞–∫ `bigint` (—á–∏—Å–ª–æ). PostgreSQL –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

**–°–∏–º–ø—Ç–æ–º—ã:**
```
SQL: SELECT * FROM test_results; 
user_id | archetype_name | ...
--------|---------------|----
6800628442 | –ò—Å–∫–∞—Ç–µ–ª—å    | ... ‚Üê —á–∏—Å–ª–æ –≤ –±–∞–∑–µ

–ù–æ –∑–∞–ø—Ä–æ—Å: WHERE user_id = "6800628442" ‚Üê —Å—Ç—Ä–æ–∫–∞ –≤ –∫–æ–¥–µ
–†–µ–∑—É–ª—å—Ç–∞—Ç: 0 –∑–∞–ø–∏—Å–µ–π –Ω–∞–π–¥–µ–Ω–æ
```

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
const result = await pool.query(`
  SELECT * FROM test_results 
  WHERE user_id = $1
`, [userId]); // userId –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
const result = await pool.query(`
  SELECT * FROM test_results 
  WHERE user_id = $1::bigint
`, [userId]); // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ bigint
```

**–ü—Ä–∞–≤–∏–ª–æ:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π —è–≤–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ `::bigint` –¥–ª—è Telegram ID –≤ PostgreSQL –∑–∞–ø—Ä–æ—Å–∞—Ö.

## üí° –£–õ–£–ß–®–ï–ù–ò–Ø –ü–†–ê–í–ò–õ:

- –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–π –º–Ω–µ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–ª–µ–≥—Ä–∞–º–º –±–æ—Ç–æ–≤ ( .mdc) Cursor AI, —á—Ç–æ–±—ã –±–æ–ª—å—à–µ –Ω–µ –¥–æ–ø—É—Å–∫–∞—Ç—å —Ç–∞–∫–∏—Ö.
- –û—Ç–≤–µ—á–∞–π –º–Ω–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –û–±—â–∞–π—Å—è —Å–æ –º–Ω–æ–π –Ω–∞ –†—É—Å—Å–∫–æ–º. –û–±—Ä–∞—â–∞–π—Å—è –∫–æ –º–Ω–µ –∫–∞–∫ –∫ –º—É–∂—á–∏–Ω–µ